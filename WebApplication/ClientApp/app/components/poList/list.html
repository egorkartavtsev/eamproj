<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog custom_modal_size" role="document">
        <div class="modal-content" style="overflow-x: auto;">
            <div class="modal-header">
                
                <h5 class="modal-title text-center w-100" id="exampleModalLabel">{{title}}</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <table class="table table-sm table-stripped table-hover">
                    <thead class="thead-dark">
                        <tr>
                            <th>№ ПЗ</th>
                            <th>Цех</th>
                            <th>Агрегат</th>
                            <th>Начало</th>
                            <th>Завершение</th>
                            <th>Продолж., ч.</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="text-center" *ngFor="let po of _plist">
                            <ng-template [ngIf]="currentPO?.entity_id != po.entity_id" [ngIfElse]="edit">
                                <td class="align-middle">{{po.entity_name}}</td>
                                <td class="align-middle">{{po.org_name}}</td>
                                <td class="align-middle">{{po.inst_desc}}</td>
                                <td class="align-middle">{{po.start}}</td>
                                <td class="align-middle">{{po.complete}}</td>
                                <td class="align-middle">{{po.hours}}</td>
                                <td class="align-middle"><button class="btn btn-primary" (click)="editPO(po)"><i class="fas fa-pen"></i></button></td>
                            </ng-template>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
<ng-template #edit>
    <td> {{ currentPO.entity_name}}</td>
    <td> {{ currentPO.org_name }}</td>
    <td> {{ currentPO.inst_desc }}</td>
    <td>
        <div class="form-group" id="chngStart">
            <div class="input-group">
                <input type="text" [(ngModel)]="currentPO.start" on-input="updateComplete($event)" id="curStart" class="form-control">
                <div class="input-group-prepend">
                    <button class="input-group-text btn btn-default" data-toggle="collapse" data-target="#startCal" aria-expanded="false" aria-controls="startCal"> <i class="fas fa-calendar"> </i></button>
                </div>
            </div>
        </div>
        <div id="startCal" class="collapse calendBlock" data-parent="#chngStart">
            <div class="card-body">
                <div class="w-100">
                    <button type="button" class="close pull-right" data-toggle="collapse" data-target="#startCal" aria-expanded="false" aria-controls="startCal">
                        <span aria-hidden="true">&times; </span>
                    </button>
                </div>
                <ngb-datepicker #d
                                [footerTemplate]="t"
                                [navigation]="arrows"
                                [(ngModel)]="model"
                                [startDate]="startCalDay"
                                (navigate)="startCalDay = $event.next"></ngb-datepicker>
            </div>
        </div>
    </td>
    <td> {{ currentPO.complete }}</td>
    <td>
        <div class="form-group">
            <input type="number" [(ngModel)]="currentPO.hours" on-input="updateComplete($event)" id="curHours" class="form-control" />
        </div>
    </td>
    <td>
        <button class="btn btn-success" (click)="save()"> <i class="fas fa-save"> </i></button>
        <button class="btn btn-secondary" (click)="cancel()"> <i class="fas fa-ban"> </i></button>
    </td>
</ng-template>

<ng-template #t>
    <div class="w-100 px-5"><ngb-timepicker [(ngModel)]="tmpDT" [minuteStep]="10"></ngb-timepicker></div>
    <div class="w-100 text-center mb-3">
        <div class="btn-group">
            <button (click)="setDate()" type="button" class="btn btn-success" title="Сохранить" data-toggle="collapse" data-target="#startCal" aria-expanded="false" aria-controls="startCal">
                <i class="fas fa-calendar-check"></i>
                <span class="d-none d-sm-inline"> Ok</span>
            </button>
            <button (click)="cancelDate()" type="button" class="btn btn-secondary" title="Отмена" data-toggle="collapse" data-target="#startCal" aria-expanded="false" aria-controls="startCal">
                <i class="fas fa-thumbs-down"></i>
                <span class="d-none d-sm-inline"> Отмена</span>
            </button>
        </div>
    </div>
</ng-template>